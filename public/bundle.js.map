{"version":3,"sources":["webpack:///webpack/bootstrap dfa94c54bd2372ef9514","webpack:///./src/adjacency-list/adjacency-list.js","webpack:///./src/canvas-parameters/canvas-parameters.js","webpack:///./src/find-bridges/find-bridges.js","webpack:///./src/spring-embedder/spring-embedder.js","webpack:///./src/svg-graph-drawer/svg-graph-drawer.js","webpack:///./src/hamma-algorithm/hamma-algorithm.js","webpack:///./src/main.scss","webpack:///./src/main.js","webpack:///./src/plane-worker/plane-worker.js","webpack:///./src/plane/plane.js","webpack:///./~/svg-catmull-rom-spline/index.js","webpack:///./~/svg-catmull-rom-spline/~/simplify-js/simplify.js"],"names":["AdjacencyList","nodes","addNode","nodeName","undefined","type","neighbors","addEdge","node1Name","node2Name","initializeFromText","nodesText","i","length","currNode","split","removeNode","node","removeEdge","removeEdges","edges","begin","end","removeEdgesWithRemovingAloneNodes","Object","keys","getConnectedComponents","components","checkedNodes","key","component","addNeighbors","call","push","print","textGroup","lastChild","removeChild","count","tspan","createTSpan","appendChild","key1","currText","key2","text","x","y","document","createElementNS","setAttribute","textContent","canvasSize","width","height","canvasCenter","printNodesAndBridgesText","bridges","calculateDepthSearchAndFindBridges","number","num","top","bypassEdges","searchNode","parentNode","Math","min","filter","edge","findBridges","l","k1","k2","delta","SpringEmbedderWorker","svgField","timers","initializeField","innerHTML","nodesGroup","edgesGroup","getNodesAndEdges","name","randomizeNodeCoordinates","floor","random","drawGraph","circle","line","clearTimers","clearInterval","firstStep","oneIteration","calculatePowerXForEachNode","calculatePowerYForEachNode","addExtention","p","f","q","ontinue","d","distance","g","FX","node1","node2","sqrt","FY","makeOneStabilization","startStabilization","timerId","setInterval","SvgGraphDrawer","draw","drawNodes","drawEdges","drawHelpLines","helpEdgesGroup","insertBefore","children","HammaAlgorithmWorker","makePlanarity","graph","planarComponents","planarizeGraph","loop","findLoop","path","planaredGraph","badSegments","planeWorker","initializeFromLoop","svgGraphDrawer","segments","findSegments","addedNodes","chain","calculateGammaFromSegments","planes","sort","segment1","segment2","gammaCount","splice","findChain","contactNodes","addChain","planesIn","removeChain","maxLoopLength","pathResult","searchLoopInNeighbors","slice","transformPathResultToLoopAndEdges","loopLength","getLoopLength","newPath","visitedNodes","includes","checkContactNode","segment","searchSegment","array","neighbor","j","isSegmentIn","isNodeInLoop","start","deepSearch","prev","current","res","chainToDelete","useSpringEmbedder","springEmbedderEdges","convertEdgesForSpringEmbedder","springEmbedderWorker","timer","addNonPlanarEdges","badChain","addBadChain","drawField","getElementById","value","randomizeNodesAndDraw","addEventListener","replace","calculateOffset","startStab","hammaAlgorithmWorker","planarityFirstStep","initGraph","useSpringEmbedderToPlanarGraph","stopTimers","currTimer","nodeRadius","canvasCorners","topLeft","topRight","bottomLeft","bottomRight","uniqueHelpPointId","PlaneWorker","radius","angle","PI","cos","sin","outerLoop","plane","triangles","findTriangles","findPathFromTriangles","putChainToPath","addPathToGraph","addChainToAddedNodes","helpPlaneInfo","isOuter","isPlaneLoopBroken","newPlanes","map","pathItem","item","id","getEdgesFromLoop","newEdges","startName","middle","endName","isCrosingWithPolygonEdges","isNodeInsidePoligone","areCrossing","p1","p2","p3","p4","v1","vectorMult","v2","v3","v4","l1","sqr","l2","ax","ay","bx","by","point","inside","xi","yi","xj","yj","intersect","trianglesPath","triangelsToSearch","isVisited","triangle","triangleItem","isNodeInTriangle","handleOneTrianglePath","isPathFind","prePath","newTrianglesPath","contactEdge","FindIfTriangleTouchAnotherTriangle","k","convertTrianglesPath","isEdgeInLoop","getPathElem","next","triangle1","triangle2","coordinates","getMiddleOfLineSegment","increasePathLength","decreasePathLength","isPathComplete","getMiddle","point1","point2","each","concat","loopEdge","areCrossingWithTouch","isLoopBroken","newStartEdge","findNewStartEdge","X","Y","deltaX","deltaY","initX","initY","isBad","uniqueID","Plane","addSimpleChain","addChainInOuterLoop","loop1","loop2","chainToWorkWith","reverse","isPlaneOuter","unshift"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap dfa94c54bd2372ef9514","function AdjacencyList() {\r\n\tthis.nodes = {};\r\n\t\r\n\tthis.addNode = function (nodeName) {\r\n\t\tif(this.nodes[nodeName]==undefined)\r\n\t\t\t\tthis.nodes[nodeName] = {\r\n\t\t\t\t\ttype: \"normal\",\r\n\t\t\t\t\tneighbors: {}\r\n\t\t\t\t\t};\r\n\t}\r\n\t\r\n\tthis.addEdge = function (node1Name, node2Name) {\r\n\t\tthis.nodes[node1Name].neighbors[node2Name] = true;\r\n\t\tthis.nodes[node2Name].neighbors[node1Name] = true;\r\n\t}\r\n\t\r\n\tthis.initializeFromText = function (nodesText) {\r\n\t\tthis.nodes = {};\r\n\t\tfor(var i = 0; i < nodesText.length; i++) {\r\n\t\t\tif (nodesText[i]!==\"\") {\r\n\t\t\t\tvar currNode = nodesText[i].split(\"->\");\r\n\t\t\t\tthis.addNode(currNode[0]);\r\n\t\t\t\t\r\n\t\t\t\tif(currNode[1])\t{\r\n\t\t\t\t\tthis.addNode(currNode[1]);\r\n\t\t\t\t\tthis.addEdge(currNode[0], currNode[1]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.removeNode = function (nodeName) {\r\n\t\tdelete this.nodes[nodeName];\r\n\t\tfor (var node in this.nodes) {\r\n\t\t\tdelete this.nodes[node].neighbors[nodeName];\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.removeEdge = function (node1Name, node2Name) {\r\n\t\tdelete this.nodes[node1Name].neighbors[node2Name];\r\n\t\tdelete this.nodes[node2Name].neighbors[node1Name];\r\n\t}\r\n\t\r\n\tthis.removeEdges = function (edges) {\r\n\t\tfor (var i = 0; i < edges.length; i++) {\r\n\t\t\tthis.removeEdge(edges[i].begin, edges[i].end);\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.removeEdgesWithRemovingAloneNodes = function (edges) {\r\n\t\tthis.removeEdges(edges);\r\n\t\tfor (var node in this.nodes) {\r\n\t\t\tif (Object.keys(this.nodes[node].neighbors).length === 0) {\r\n\t\t\t\tthis.removeNode(node);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.getConnectedComponents = function () {\r\n\t\tvar components = [];\r\n\t\tvar checkedNodes = [];\r\n\t\t\r\n\t\tfor (var key in this.nodes) {\r\n\t\t\tif(checkedNodes[key]) continue;\r\n\t\t\t\r\n\t\t\tcheckedNodes[key] = true;\r\n\t\t\t\r\n\t\t\tvar component = new AdjacencyList();\r\n\t\t\t\r\n\t\t\tcomponent.addNode(key);\r\n\t\t\taddNeighbors.call(this, key, component, checkedNodes);\r\n\t\t\tcomponents.push(component);\r\n\t\t}\r\n\t\t\r\n\t\tfunction addNeighbors(nodeName, component, checkedNodes) {\r\n\t\t\tfor (var key in this.nodes[nodeName].neighbors) {\r\n\t\t\t\tcomponent.addNode(key);\r\n\t\t\t\tcomponent.addEdge(nodeName, key);\r\n\t\t\t\t\r\n\t\t\t\tif (!checkedNodes[key]) {\r\n\t\t\t\t\tcheckedNodes[key] = true;\r\n\t\t\t\t\taddNeighbors.call(this, key, component, checkedNodes);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn components;\r\n\t}\r\n\t\r\n\tthis.print = function (textGroup) {\r\n\t\twhile (textGroup.lastChild) {\r\n\t\t\ttextGroup.removeChild(textGroup.lastChild);\r\n\t\t}\r\n\r\n\t\tvar count = 0;\r\n\t\r\n\t\tvar tspan = createTSpan(\"Списки смежности:\", 50, (count + 1) * 50);\r\n\t\ttextGroup.appendChild(tspan);\r\n\t\tcount++;\r\n\t\t\r\n\t\tfor (var key1 in this.nodes) {\r\n\t\t\tvar currText = key1 + \": \";\r\n\t\t\tfor (var key2 in this.nodes[key1].neighbors) {\r\n\t\t\t\tcurrText+=key2+\", \";\r\n\t\t\t}\r\n\t\t\ttspan = createTSpan(currText, 50, (count + 1) * 50);\r\n\t\t\ttextGroup.appendChild(tspan);\r\n\t\t\t\r\n\t\t\tcount++;\r\n\t\t}\r\n\t\t\r\n\t\tfunction createTSpan(text, x, y) {\r\n\t\t\tvar tspan = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");\r\n\t\t\ttspan.setAttribute(\"x\", x);\r\n\t\t\ttspan.setAttribute(\"y\", y);\r\n\t\t\ttspan.textContent = text;\r\n\t\t\treturn tspan;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default AdjacencyList;\n\n\n// WEBPACK FOOTER //\n// ./src/adjacency-list/adjacency-list.js","const canvasSize = {\r\n\twidth: 1500,\r\n\theight: 800\r\n}\r\n\r\nconst canvasCenter = {\r\n\tx: 400,\r\n\ty: 400\r\n};\r\n\r\nexport {canvasSize, canvasCenter};\n\n\n// WEBPACK FOOTER //\n// ./src/canvas-parameters/canvas-parameters.js","function createTSpan(text, x, y) {\r\n\tvar tspan = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");\r\n\ttspan.setAttribute(\"x\", x);\r\n\ttspan.setAttribute(\"y\", y);\r\n\ttspan.textContent = text;\r\n\treturn tspan;\r\n}\r\n\r\n//print adjacency list and bridges\r\nfunction printNodesAndBridgesText(nodes, bridges, textGroup) {\r\n\t    while (textGroup.lastChild) {\r\n            textGroup.removeChild(textGroup.lastChild);\r\n        }\r\n\tvar count = 0;\r\n\t\r\n\tvar tspan = createTSpan(\"Списки смежности:\", 50, (count + 1) * 50);\r\n\ttextGroup.appendChild(tspan);\r\n\tcount++;\r\n\t\r\n\tfor (var key1 in nodes) {\r\n\t\tvar currText = key1 + \": \";\r\n\t\tfor (var key2 in nodes[key1].neighbors) {\r\n\t\t\tcurrText+=key2+\", \";\r\n\t\t}\r\n\t\ttspan = createTSpan(currText, 50, (count + 1) * 50);\r\n\t\ttextGroup.appendChild(tspan);\r\n\t\t\r\n\t\tcount++;\r\n\t}\t\r\n\t\r\n\ttspan = createTSpan(\"Мосты:\", 50, (count + 1) * 50);\r\n\ttextGroup.appendChild(tspan);\r\n\tcount++;\r\n\t\r\n\tfor (var i = 0; i < bridges.length; i++, count++) {\t\t\r\n\t\ttspan = createTSpan(bridges[i].begin + \" -> \" + bridges[i].end + \"; \", 50, (count + 1) * 50);\r\n\t\ttextGroup.appendChild(tspan);\t\t\r\n\t}\r\n}\r\n\r\nfunction calculateDepthSearchAndFindBridges(nodes) {\r\n\tvar number = 1;\r\n\t\r\n\tvar num = {};\r\n\tvar top = {};\r\n\t//edges we walk in depth search\r\n\tvar bypassEdges = [];\r\n\t\r\n\tfor (var key in nodes) {\r\n\t\tnum[key] = 0;\r\n\t}\r\n\t\r\n\tfor (var key in nodes) {\r\n\t\tif (num[key] != 0) continue;\r\n\t\t\r\n\t\tsearchNode(undefined, key);\r\n\t}\r\n\t\r\n\tfunction searchNode(parentNode, currNode) {\r\n\t\tnum[currNode] = number; \r\n\t\ttop[currNode] = number;\r\n\t\tnumber++;\r\n\t\t\r\n\t\tfor (var key in nodes[currNode].neighbors) {\r\n\t\t\tif(num[key] == 0) {\r\n\t\t\t\tbypassEdges.push({\r\n\t\t\t\t\tbegin: currNode,\r\n\t\t\t\t\tend: key\r\n\t\t\t\t});\r\n\t\t\t\tsearchNode(currNode, key);\r\n\t\t\t\ttop[currNode] = Math.min(top[currNode], top[key]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif(parentNode != key)\r\n\t\t\t\t\ttop[currNode] = Math.min(top[currNode], num[key]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn bypassEdges.filter((edge) => {\r\n\t\treturn top[edge.end] == num[edge.end];\r\n\t});\r\n}\r\n\r\n//nodes text: [\"a->b\", \"b->c\", \"\"]\r\nfunction findBridges(nodes, textGroup) {\r\n\treturn calculateDepthSearchAndFindBridges(nodes);\r\n}\r\n\r\nexport {findBridges};\n\n\n// WEBPACK FOOTER //\n// ./src/find-bridges/find-bridges.js","//������������ ����� �������\r\nvar l = 100;\r\n//����������� ��������� �������\r\nvar k1 = 2;\r\n//����������� ���� ������������\r\nvar k2 = 200000;\r\n\r\nvar delta = 0.1;\r\n/*\r\nfunction clear(nodesGroup, edgesGroup){\r\n\tnodesGroup.innerHTML=\"\";\r\n\tedgesGroup.innerHTML=\"\";\r\n}\r\nfunction getNodesAndEdges(nodesText){\r\n\tnodes={};\r\n\tedges={};\r\n\tfor(var i = 0; i< nodesText.length; i++)\r\n\t{\r\n\t\tif ( nodesText[i]!=\"\")\r\n\t\t{\r\n\t\t\tvar currNode = nodesText[i].split(\"->\");\r\n\t\t\tnodes[currNode[0]] = {name: currNode[0]};\r\n\t\t\tif(currNode[1])\r\n\t\t\t{\t\t\r\n\t\t\t\tnodes[currNode[1]] = {name: currNode[1]};\r\n\t\t\t\tif(!edges[currNode[0]])\r\n\t\t\t\t\tedges[currNode[0]]={};\r\n\t\t\t\tedges[currNode[0]][currNode[1]]=true;\r\n\t\t\t\t\r\n\t\t\t\t//����� ���� �������� � ������������������ �������\r\n\t\t\t\tif(!edges[currNode[1]])\r\n\t\t\t\t\tedges[currNode[1]]={};\r\n\t\t\t\tedges[currNode[1]][currNode[0]]=true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nfunction randomizeNodeCoordinates(height, width){\r\n\tfor(var key in nodes){\r\n\t\tnodes[key].x =Math.floor(Math.random() * (width - 0 + 1)) + 0;\r\n\t\tnodes[key].y =Math.floor(Math.random() * (height - 0 + 1)) + 0;\r\n\t}\r\n}\r\nfunction drawGraph(nodesGroup, edgesGroup){\r\n\tfor(var key in  nodes){\r\n\t\tvar circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\r\n\t\tcircle.setAttribute('cx', nodes[key].x);\r\n\t\tcircle.setAttribute('cy', nodes[key].y);\r\n\t\tcircle.setAttribute('r', 15);\r\n\t\tcircle.setAttribute('stroke', \"black\");\r\n\t\tcircle.setAttribute('stroke-width', 2);\r\n\t\tcircle.setAttribute('fill', \"white\");\t\t\r\n\t\tnodesGroup.appendChild(circle);\r\n\t\t\r\n\t\tvar text = document.createElementNS('http://www.w3.org/2000/svg', 'text');\r\n\t\ttext.setAttribute('x', nodes[key].x-2);\r\n\t\ttext.setAttribute('y', nodes[key].y+2);\r\n\t\ttext.setAttribute('fill', \"black\");\r\n\t\ttext.innerHTML= key;\r\n\t\tnodesGroup.appendChild(text);\r\n\t}\r\n\t\r\n\tfor(var key1 in edges){\t\t\r\n\t\tfor(var key2 in edges[key1]){\r\n\t\t\tvar line = document.createElementNS('http://www.w3.org/2000/svg', 'line');\r\n\t\t\tline.setAttribute('x1', nodes[key1].x);\r\n\t\t\tline.setAttribute('y1', nodes[key1].y);\r\n\t\t\tline.setAttribute('x2', nodes[key2].x);\r\n\t\t\tline.setAttribute('y2', nodes[key2].y);\r\n\t\t\tline.setAttribute('stroke', \"black\");\r\n\t\t\tline.setAttribute('stroke-width', 2);\r\n\t\t\tedgesGroup.appendChild(line);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction firstStep(nodesText, timerId, height, width, nodesGroup, edgesGroup){\r\n\tif(timerId)\r\n\t\tclearInterval(timerId);\r\n\tclear(nodesGroup, edgesGroup);\r\n\tgetNodesAndEdges(nodesText);\r\n\trandomizeNodeCoordinates(height, width);\r\n\tdrawGraph(nodesGroup, edgesGroup);\r\n}\r\nfunction makeOneStabilization(nodesGroup, edgesGroup){\r\n\tcalculatePowerXForEachNode();\r\n\tcalculatePowerYForEachNode();\r\n\taddExtention();\r\n\tclear(nodesGroup, edgesGroup);\r\n\tdrawGraph(nodesGroup, edgesGroup);\r\n\t\r\n\tfunction calculatePowerXForEachNode(){\r\n\t\tfor(var p in nodes){\r\n\t\t\tvar f=0;\r\n\t\t\tfor(var q in edges[p]){\r\n\t\t\t\tif (edges[p][q]==undefined)continue;\r\n\t\t\t\tvar d = distance(p,q);\r\n\t\t\t\tif (d == 0) continue;\r\n\t\t\t\tf+=k1 * (d - l) * (nodes[q].x - nodes[p].x) / d;\r\n\t\t\t}\r\n\t\t\tvar g=0;\r\n\t\t\tfor(var q in nodes){\r\n\t\t\t\t//if(edges[p][q]!=undefined||q==p)continue;\r\n\t\t\t\tif(q==p)continue;\r\n\t\t\t\tvar d = distance(p,q);\r\n\t\t\t\tif (d == 0) continue;\r\n\t\t\t\tg+=k2 * (nodes[p].x - nodes[q].x) / (d * d)  / d;\r\n\t\t\t}\r\n\t\t\tnodes[p].FX=f+g;\r\n\t\t}\r\n\t\t\r\n\t\tfunction distance(node1, node2){\r\n\t\t\tvar x = nodes[node1].x-nodes[node2].x;\r\n\t\t\tvar y = nodes[node1].y-nodes[node2].y;\r\n\t\t\treturn Math.sqrt(x*x + y*y);\r\n\t\t}\r\n\t}\r\n\tfunction calculatePowerYForEachNode(){\r\n\t\tfor(var p in nodes){\r\n\t\t\tvar f=0;\r\n\t\t\tfor(var q in edges[p]){\r\n\t\t\t\tif (edges[p][q]==undefined)continue;\r\n\t\t\t\tvar d = distance(p,q);\r\n\t\t\t\tif (d == 0) continue;\r\n\t\t\t\tf+=k1 * (d - l) * (nodes[q].y - nodes[p].y) / d;\r\n\t\t\t}\r\n\t\t\tvar g=0;\r\n\t\t\tfor(var q in nodes){\r\n\t\t\t\t//if(edges[p][q]!=undefined||q==p)continue;\r\n\t\t\t\tif(q==p)continue;\r\n\t\t\t\tvar d = distance(p,q);\r\n\t\t\t\tif (d == 0) continue;\r\n\t\t\t\tg+=k2 * (nodes[p].y - nodes[q].y) / (d * d)   / d;\r\n\t\t\t}\r\n\t\t\tnodes[p].FY= f + g;\r\n\t\t}\r\n\t}\r\n\tfunction addExtention(){\r\n\t\tfor(var node in nodes){\r\n\t\t\tnodes[node].x+=delta*nodes[node].FX;\r\n\t\t\tnodes[node].y+=delta*nodes[node].FY;\r\n\t\t\t//nodes[node].x=nodes[node].FX;\r\n\t\t\t//nodes[node].y=nodes[node].FY;\r\n\t\t\tif (nodes[node].x < 15) nodes[node].x = 15;\r\n\t\t\tif (nodes[node].y < 15) nodes[node].y = 15;\r\n\t\t}\r\n\t}\r\n}\r\nfunction startStabilization(timerId, nodesGroup, edgesGroup){\r\n\ttimerId = setInterval(makeOneStabilization, 150, nodesGroup, edgesGroup);\r\n\treturn timerId;\r\n}\r\nexport {firstStep, makeOneStabilization, startStabilization};\r\n*/\r\nfunction SpringEmbedderWorker (svgField) {\r\n\tthis.nodes = {};\r\n\tthis.edges = {};\r\n\tthis.timers = [];\r\n\tthis.svgField = svgField;\r\n\t\r\n\tthis.initializeField = function () {\r\n\t\tthis.svgField.innerHTML = \"\";\r\n\t\t\r\n\t\tthis.nodesGroup = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\r\n\t\tthis.nodesGroup.setAttribute('id', 'nodes');\r\n\r\n\t\tthis.edgesGroup = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\r\n\t\tthis.edgesGroup.setAttribute('id', 'edges');\r\n\t\t\r\n\t\tthis.svgField.appendChild(this.edgesGroup);\r\n\t\tthis.svgField.appendChild(this.nodesGroup);\r\n\t}\r\n\t\r\n\tthis.getNodesAndEdges = function (nodesText) {\r\n\tthis.nodes = {};\r\n\tthis.edges = {};\r\n\tfor (var i = 0; i < nodesText.length; i++)\r\n\t{\r\n\t\tif (nodesText[i] !== \"\") {\r\n\t\t\tvar currNode = nodesText[i].split(\"->\");\r\n\t\t\tthis.nodes[currNode[0]] = {name: currNode[0]};\r\n\t\t\tif (currNode[1]) {\r\n\t\t\t\tthis.nodes[currNode[1]] = {name: currNode[1]};\r\n\t\t\t\tif (!this.edges[currNode[0]])\r\n\t\t\t\t\tthis.edges[currNode[0]] = {};\r\n\t\t\t\tthis.edges[currNode[0]][currNode[1]] = true;\r\n\t\t\t\t\r\n\t\t\t\t//����� ���� �������� � ������������������ �������\r\n\t\t\t\tif(!this.edges[currNode[1]])\r\n\t\t\t\t\tthis.edges[currNode[1]] = {};\r\n\t\t\t\tthis.edges[currNode[1]][currNode[0]] = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\t\r\n\tthis.randomizeNodeCoordinates = function (height, width) {\r\n\t\tfor(var key in this.nodes){\r\n\t\t\tthis.nodes[key].x = Math.floor(Math.random() * (width - 0 + 1)) + 0;\r\n\t\t\tthis.nodes[key].y = Math.floor(Math.random() * (height - 0 + 1)) + 0;\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.drawGraph = function () {\r\n\t\tfor (var key in  this.nodes) {\r\n\t\t\tvar circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\r\n\t\t\tcircle.setAttribute('cx', this.nodes[key].x);\r\n\t\t\tcircle.setAttribute('cy', this.nodes[key].y);\r\n\t\t\tcircle.setAttribute('r', 15);\r\n\t\t\tcircle.setAttribute('stroke', \"black\");\r\n\t\t\tcircle.setAttribute('stroke-width', 2);\r\n\t\t\tcircle.setAttribute('fill', \"white\");\r\n\t\t\tthis.nodesGroup.appendChild(circle);\r\n\t\t\t\r\n\t\t\tvar text = document.createElementNS('http://www.w3.org/2000/svg', 'text');\r\n\t\t\ttext.setAttribute('x', this.nodes[key].x - 2);\r\n\t\t\ttext.setAttribute('y', this.nodes[key].y + 2);\r\n\t\t\ttext.setAttribute('fill', \"black\");\r\n\t\t\ttext.innerHTML = key;\r\n\t\t\tthis.nodesGroup.appendChild(text);\r\n\t\t}\r\n\t\t\r\n\t\tfor (var key1 in this.edges) {\r\n\t\t\tfor (var key2 in this.edges[key1]) {\r\n\t\t\t\tvar line = document.createElementNS('http://www.w3.org/2000/svg', 'line');\r\n\t\t\t\tline.setAttribute('x1', this.nodes[key1].x);\r\n\t\t\t\tline.setAttribute('y1', this.nodes[key1].y);\r\n\t\t\t\tline.setAttribute('x2', this.nodes[key2].x);\r\n\t\t\t\tline.setAttribute('y2', this.nodes[key2].y);\r\n\t\t\t\tline.setAttribute('stroke', \"black\");\r\n\t\t\t\tline.setAttribute('stroke-width', 2);\r\n\t\t\t\tthis.edgesGroup.appendChild(line);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.clearTimers = function () {\r\n\t\tfor (var i = 0; i < this.timers.length; i++) {\r\n\t\t\tclearInterval(this.timers[i]);\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.firstStep = function (nodesText, height, width) {\r\n\t\tthis.clearTimers();\r\n\t\tthis.initializeField();\r\n\t\tthis.getNodesAndEdges(nodesText);\r\n\t\tthis.randomizeNodeCoordinates(height, width);\r\n\t\tthis.drawGraph();\r\n\t}\r\n\t\r\n\tthis.oneIteration = function () {\r\n\t\tcalculatePowerXForEachNode.call(this);\r\n\t\tcalculatePowerYForEachNode.call(this);\r\n\t\taddExtention.call(this);\r\n\t\t\r\n\t\tfunction calculatePowerXForEachNode() {\r\n\t\t\tfor(var p in this.nodes) {\r\n\t\t\t\tvar f = 0;\r\n\t\t\t\tfor (var q in this.edges[p]) {\r\n\t\t\t\t\tif (this.edges[p][q] === undefined) ontinue;\r\n\t\t\t\t\tvar d = distance.call(this, p, q);\r\n\t\t\t\t\tif (d == 0) continue;\r\n\t\t\t\t\tf += k1 * (d - l) * (this.nodes[q].x - this.nodes[p].x) / d;\r\n\t\t\t\t}\r\n\t\t\t\tvar g = 0;\r\n\t\t\t\tfor (var q in this.nodes) {\r\n\t\t\t\t\t//if(this.edges[p][q]!=undefined||q==p)continue;\r\n\t\t\t\t\tif (q === p) continue;\r\n\t\t\t\t\tvar d = distance.call(this, p, q);\r\n\t\t\t\t\tif (d === 0) continue;\r\n\t\t\t\t\tg += k2 * (this.nodes[p].x - this.nodes[q].x) / (d * d) / d;\r\n\t\t\t\t}\r\n\t\t\t\tthis.nodes[p].FX = f + g;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction distance(node1, node2) {\r\n\t\t\t\tvar x = this.nodes[node1].x - this.nodes[node2].x;\r\n\t\t\t\tvar y = this.nodes[node1].y - this.nodes[node2].y;\r\n\t\t\t\treturn Math.sqrt(x*x + y*y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction calculatePowerYForEachNode() {\r\n\t\t\tfor (var p in this.nodes) {\r\n\t\t\t\tvar f = 0;\r\n\t\t\t\tfor (var q in this.edges[p]) {\r\n\t\t\t\t\tif (this.edges[p][q] === undefined) continue;\r\n\t\t\t\t\tvar d = distance.call(this, p,q);\r\n\t\t\t\t\tif (d === 0) continue;\r\n\t\t\t\t\tf += k1 * (d - l) * (this.nodes[q].y - this.nodes[p].y) / d;\r\n\t\t\t\t}\r\n\t\t\t\tvar g = 0;\r\n\t\t\t\tfor (var q in this.nodes) {\r\n\t\t\t\t\t//if(this.edges[p][q]!=undefined||q==p)continue;\r\n\t\t\t\t\tif (q === p) continue;\r\n\t\t\t\t\tvar d = distance.call(this, p,q);\r\n\t\t\t\t\tif (d === 0) continue;\r\n\t\t\t\t\tg += k2 * (this.nodes[p].y - this.nodes[q].y) / (d * d) / d;\r\n\t\t\t\t}\r\n\t\t\t\tthis.nodes[p].FY = f + g;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction distance(node1, node2) {\r\n\t\t\t\tvar x = this.nodes[node1].x - this.nodes[node2].x;\r\n\t\t\t\tvar y = this.nodes[node1].y - this.nodes[node2].y;\r\n\t\t\t\treturn Math.sqrt(x*x + y*y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction addExtention() {\r\n\t\t\tfor (var node in this.nodes) {\r\n\t\t\t\tthis.nodes[node].x += delta * this.nodes[node].FX;\r\n\t\t\t\tthis.nodes[node].y += delta * this.nodes[node].FY;\r\n\t\t\t\t//nodes[node].x=nodes[node].FX;\r\n\t\t\t\t//nodes[node].y=nodes[node].FY;\r\n\t\t\t\tif (this.nodes[node].x < 15) this.nodes[node].x = 15;\r\n\t\t\t\tif (this.nodes[node].y < 15) this.nodes[node].y = 15;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.makeOneStabilization = function () {\r\n\t\tthis.oneIteration();\r\n\t\tthis.initializeField();\r\n\t\tthis.drawGraph();\r\n\t}\r\n\t\r\n\tthis.startStabilization = function () {\r\n\t\tvar timerId = setInterval(() => {\r\n\t\t\tthis.makeOneStabilization.call(this);\r\n\t\t}, 150);\r\n\t\tthis.timers.push(timerId);\r\n\t}\r\n}\r\n\r\nexport default SpringEmbedderWorker;\n\n\n// WEBPACK FOOTER //\n// ./src/spring-embedder/spring-embedder.js","import SVGCatmullRomSpline from 'svg-catmull-rom-spline';\r\n\r\nfunction SvgGraphDrawer (svgField) {\r\n\tthis.svgField = svgField;\r\n\tthis.draw = function (nodes, edges) {\r\n\t\tthis.initializeField();\r\n\t\tthis.drawNodes(nodes);\r\n\t\tthis.drawEdges(nodes, edges);\r\n\t}\r\n\tthis.initializeField = function () {\r\n\t\tthis.svgField.innerHTML = \"\";\r\n\t\t\r\n\t\tthis.nodesGroup = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\r\n\t\tthis.nodesGroup.setAttribute('id', 'nodes');\r\n\r\n\t\tthis.edgesGroup = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\r\n\t\tthis.edgesGroup.setAttribute('id', 'edges');\r\n\t\t\r\n\t\tthis.svgField.appendChild(this.edgesGroup);\r\n\t\tthis.svgField.appendChild(this.nodesGroup);\r\n\t}\r\n\t\r\n\tthis.drawNodes = function (nodes) {\r\n\t\tfor(var key in  nodes){\r\n\t\t\tvar circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\r\n\t\t\tcircle.setAttribute('cx', nodes[key].x);\r\n\t\t\tcircle.setAttribute('cy', nodes[key].y);\r\n\t\t\tif(nodes[key].type === \"fictive\") {\r\n\t\t\t\tcircle.setAttribute('stroke-dasharray', \"5\");\r\n\t\t\t}\r\n\t\t\tcircle.setAttribute('stroke', \"black\");\r\n\t\t\tcircle.setAttribute('stroke-width', 2);\r\n\t\t\t\r\n\t\t\tif (nodes[key].type === \"helpNode\") {\r\n\t\t\t\tcircle.setAttribute('fill', \"black\");\r\n\t\t\t\tcircle.setAttribute('r', 5);\r\n\t\t\t} else {\r\n\t\t\t\tcircle.setAttribute('fill', \"white\");\r\n\t\t\t\tcircle.setAttribute('r', 15);\r\n\t\t\t}\r\n\t\t\tthis.nodesGroup.appendChild(circle);\r\n\t\t\t\r\n\t\t\tif (nodes[key].type !== \"helpNode\") {\r\n\t\t\t\tvar text = document.createElementNS('http://www.w3.org/2000/svg', 'text');\r\n\t\t\t\ttext.setAttribute('x', nodes[key].x-2);\r\n\t\t\t\ttext.setAttribute('y', nodes[key].y+2);\r\n\t\t\t\ttext.setAttribute('fill', \"black\");\r\n\t\t\t\ttext.innerHTML= key;\r\n\t\t\t\tthis.nodesGroup.appendChild(text);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.drawEdges = function (nodes, edges) {\r\n\t\tfor (var i = 0; i < edges.length; i++) {\r\n\t\t\tvar line = document.createElementNS('http://www.w3.org/2000/svg', 'line');\r\n\t\t\tline.setAttribute('x1', nodes[edges[i].begin].x);\r\n\t\t\tline.setAttribute('y1', nodes[edges[i].begin].y);\r\n\t\t\tline.setAttribute('x2', nodes[edges[i].end].x);\r\n\t\t\tline.setAttribute('y2', nodes[edges[i].end].y);\r\n\t\t\tline.setAttribute('stroke', \"black\");\r\n\t\t\tline.setAttribute('stroke-width', 2);\r\n\t\t\tthis.edgesGroup.appendChild(line);\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.drawHelpLines = function (edges) {\r\n\t\tthis.helpEdgesGroup = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\r\n\t\tthis.svgField.insertBefore(this.helpEdgesGroup, this.svgField.children[0]);\r\n\t\tfor (var i = 0; i < edges.length; i++) {\r\n\t\t\tvar line = document.createElementNS('http://www.w3.org/2000/svg', 'line');\r\n\t\t\tline.setAttribute('x1', edges[i].begin.x);\r\n\t\t\tline.setAttribute('y1', edges[i].begin.y);\r\n\t\t\tline.setAttribute('x2', edges[i].end.x);\r\n\t\t\tline.setAttribute('y2', edges[i].end.y);\r\n\t\t\tline.setAttribute('stroke-dasharray', \"5\");\r\n\t\t\tline.setAttribute('stroke', \"black\");\r\n\t\t\tline.setAttribute('stroke-width', 2);\r\n\t\t\tthis.helpEdgesGroup.appendChild(line);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default SvgGraphDrawer;\n\n\n// WEBPACK FOOTER //\n// ./src/svg-graph-drawer/svg-graph-drawer.js","import AdjacencyList from 'adjacency-list';\r\nimport {findBridges} from 'find-bridges';\r\nimport PlaneWorker from 'plane-worker';\r\nimport SvgGraphDrawer from 'svg-graph-drawer';\r\nimport SpringEmbedderWorker from 'spring-embedder';\r\n\r\nfunction HammaAlgorithmWorker (svgField) {\r\n\tthis.svgField = svgField;\r\n\tthis.makePlanarity = function (graph) {\r\n\t\tvar bridges = findBridges(graph.nodes);\r\n\t\tgraph.removeEdges(bridges);\r\n\t\tvar planarComponents = [];\r\n\t\tvar components = graph.getConnectedComponents();\r\n\t\tfor (var i = 0; i < components.length; i++) {\r\n\t\t\tplanarComponents.push(this.planarizeGraph(components[i]));\r\n\t\t}\r\n\t\treturn planarComponents;\r\n\t}\r\n\t\r\n\t//graph without bridges\r\n\tthis.planarizeGraph = function (graph) {\r\n\t\tvar loop = this.findLoop(graph);\r\n\t\tif (loop.path.length == 0) return {\r\n\t\t\tplanaredGraph: new PlaneWorker(loop),\r\n\t\t\tbadSegments: [],\r\n\t\t\tgraph: graph\r\n\t\t};\r\n\t\tvar planeWorker = new PlaneWorker();\r\n\t\tplaneWorker.initializeFromLoop(loop.path);\r\n\r\n\t\tvar svgGraphDrawer = new SvgGraphDrawer(svgField);\r\n\t\tsvgGraphDrawer.draw(planeWorker.nodes, planeWorker.edges);\r\n\t\tgraph.removeEdges(loop.edges); //убрать также вершины ни с чем не соединенные //мб не надо\r\n\t\t\r\n\t\tvar segments = this.findSegments(graph, planeWorker.addedNodes);;\r\n\t\tvar badSegments = [];\r\n\t\t//while segments.length != 0\r\n\t\tvar chain;\r\n\r\n\t\twhile (segments.length != 0) {\r\n\t\t\tthis.calculateGammaFromSegments(segments, planeWorker.planes);\r\n\t\t\tsegments.sort((segment1, segment2) => {\r\n\t\t\t\treturn segment1.gammaCount > segment2.gammaCount ? 1 : -1;\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t//remove one of the contact nodes\r\n\t\t\tif (segments[0].gammaCount === 0) {\r\n\t\t\t\tbadSegments.push(segments[0]);\r\n\t\t\t\tsegments.splice(0, 1);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tchain = this.findChain(segments[0], segments[0].contactNodes[0], segments[0].contactNodes[1]);\r\n\t\t\tplaneWorker.addChain(chain, segments[0].planesIn[0]);\r\n\t\t\tthis.removeChain(graph, chain);\r\n\t\t\tsegments = this.findSegments(graph, planeWorker.addedNodes);\r\n\t\t\tsvgGraphDrawer.draw(planeWorker.nodes, planeWorker.edges);\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tplanaredGraph: planeWorker,\r\n\t\t\tbadSegments: badSegments,\r\n\t\t\tgraph: graph\r\n\t\t};\r\n\t\t/*var springEmbedderEdges = this.convertEdgesForSpringEmbedder(planeWorker.edges);\r\n\t\t\r\n\t\tvar springEmbedderWorker = new SpringEmbedderWorker(svgField);\r\n\t\tspringEmbedderWorker.nodes = planeWorker.nodes;\r\n\t\tspringEmbedderWorker.edges = springEmbedderEdges;*/\r\n\t\t\r\n\t\t//springEmbedderWorker.oneIteration();\r\n\t\t//for (var i = 0; i < 20; i++) {\r\n\t\t//while (true) {\r\n\t\t\t/*springEmbedderWorker.makeOneStabilization();*/\r\n\t\t\t/*setInterval(() => {\r\n\t\t\t\tspringEmbedderWorker.oneIteration();\r\n\t\t\t\tsvgGraphDrawer.draw(planeWorker.nodes, planeWorker.edges);\r\n\t\t\t}, 150);*/\r\n\t\t//}\r\n\t\t/*var badChain;\r\n\t\t//put bad segments as is\r\n\t\twhile (badSegments.length !== 0) {\r\n\t\t\tbadChain = this.findChain(badSegments[0], badSegments[0].contactNodes[0], badSegments[0].contactNodes[1]);\r\n\t\t\t\r\n\t\t\tplaneWorker.addBadChain(badChain);\r\n\t\t\tthis.removeChain(graph, badChain);\r\n\t\t\tbadSegments = this.findSegments(graph, planeWorker.addedNodes);\r\n\t\t\tsvgGraphDrawer.draw(planeWorker.nodes, planeWorker.edges);\r\n\t\t}*/\r\n\t}\r\n\t\r\n\t//awful algorithm, works in n^n time\r\n\tthis.findLoop = function (graph) {\r\n\t\tvar maxLoopLength = 0;\r\n\t\tvar pathResult = [];\r\n\t\t\r\n\t\tfor (var key in graph.nodes) {\r\n\t\t\tvar path = [];\r\n\t\t\tpath.push(key);\r\n\t\t\t\r\n\t\t\tsearchLoopInNeighbors(path.slice(), key, graph);\r\n\t\t}\r\n\t\t/*!!!\r\n\t\tpathResult = [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\"];*/\r\n\t\treturn transformPathResultToLoopAndEdges(pathResult);\r\n\t\t\r\n\t\tfunction searchLoopInNeighbors(path, nodeName, graph) {\r\n\t\t\tfor (var key in graph.nodes[nodeName].neighbors) {\r\n\t\t\t\t//if node already was in our path we compare loop length with max loop length\r\n\t\t\t\tvar loopLength = getLoopLength(path, key);\r\n\t\t\t\tif (loopLength > maxLoopLength) {\r\n\t\t\t\t\tmaxLoopLength = loopLength;\r\n\t\t\t\t\tpathResult = path.slice();\r\n\t\t\t\t}\r\n\t\t\t\telse if (loopLength === 0) {\r\n\t\t\t\t\tvar newPath = path.slice();\r\n\t\t\t\t\tnewPath.push(key);\r\n\t\t\t\t\tsearchLoopInNeighbors(newPath, key, graph);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction getLoopLength(path, nodeName) {\r\n\t\t\t\tfor (var i = 0; i < path.length; i++) {\r\n\t\t\t\t\tif (path[i] === nodeName) return path.length - i;\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfunction transformPathResultToLoopAndEdges(pathResult) {\r\n\t\t\tvar loop = [];\r\n\t\t\t\r\n\t\t\tfor (var i = 0; i < pathResult.length - 1; i++) {\r\n\t\t\t\tloop.push({\r\n\t\t\t\t\tbegin: pathResult[i],\r\n\t\t\t\t\tend: pathResult[i + 1]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tloop.push({\r\n\t\t\t\tbegin: pathResult[0],\r\n\t\t\t\tend: pathResult[pathResult.length - 1]\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\treturn {\r\n\t\t\t\tpath: pathResult,\r\n\t\t\t\tedges: loop\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t//find all segments that \"touches\" an added nodes\r\n\tthis.findSegments = function (graph, addedNodes) {\r\n\t\tvar visitedNodes = {};\r\n\t\tvar segments = [];\r\n\t\t\r\n\t\tfor (var key in graph.nodes) {\r\n\t\t\tif (visitedNodes[key]) continue;\r\n\t\t\tvisitedNodes[key] = true;\r\n\t\t\t\r\n\t\t\tif (includes(addedNodes, key)) {\r\n\t\t\t\tcheckContactNode(key, graph, segments, addedNodes);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tvar segment = {\r\n\t\t\t\tcontactNodes: [],\r\n\t\t\t\tgraph: new AdjacencyList()\r\n\t\t\t};\r\n\t\t\tsegment.graph.addNode(key);\r\n\t\t\tsearchSegment(segment, key, addedNodes, graph);\r\n\t\t\tsegments.push(segment);\r\n\t\t}\r\n\t\t\r\n\t\treturn segments;\r\n\t\t\r\n\t\tfunction includes (array, key) {\r\n\t\t\tfor (var i = 0; i < array.length; i++) {\r\n\t\t\t\tif (array[i] === key) return true;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tfunction checkContactNode (node, graph, segments, addedNodes) {\r\n\t\t\tfor (var neighbor in graph.nodes[node].neighbors) {\r\n\t\t\t\t\tif (includes(addedNodes, neighbor) && !visitedNodes[neighbor]) {\r\n\t\t\t\t\t\tvar segment = {\r\n\t\t\t\t\t\t\tcontactNodes: [],\r\n\t\t\t\t\t\t\tgraph:  new AdjacencyList()\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tsegment.graph.addNode(node);\r\n\t\t\t\t\t\tsegment.contactNodes.push(node);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsegment.graph.addNode(neighbor);\r\n\t\t\t\t\t\tsegment.contactNodes.push(neighbor);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsegment.graph.addEdge(node, neighbor);\r\n\t\t\t\t\t\tsegments.push(segment);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t//node is not in the addedNodes\r\n\t\tfunction searchSegment(segment, node, addedNodes, graph) {\r\n\t\t\tvisitedNodes[node] = true;\r\n\t\t\tfor (var neighbor in graph.nodes[node].neighbors) {\r\n\t\t\t\t\r\n\t\t\t\tsegment.graph.addNode(neighbor);\r\n\t\t\t\tsegment.graph.addEdge(node, neighbor);\r\n\t\t\t\t\r\n\t\t\t\tif (includes(addedNodes, neighbor)) {\r\n\t\t\t\t\tsegment.contactNodes.push(neighbor);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (!visitedNodes[neighbor]) {\r\n\t\t\t\t\tsearchSegment(segment, neighbor, addedNodes, graph);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.calculateGammaFromSegments = function (segments, planes) {\r\n\t\tfor (var i = 0; i < segments.length; i++) {\r\n\t\t\tsegments[i].planesIn = [];\r\n\t\t\tvar gammaCount = 0;\r\n\t\t\tfor (var j = 0; j < planes.length; j++) {\r\n\t\t\t\tif (isSegmentIn(segments[i].contactNodes, planes[j].loop)) {\r\n\t\t\t\t\tgammaCount++;\r\n\t\t\t\t\tsegments[i].planesIn.push(planes[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsegments[i].gammaCount = gammaCount; //добавить сортировку граней (внутренняя - не внутренняя)\r\n\t\t}\r\n\t\t\r\n\t\tfunction isSegmentIn(contactNodes, loop) {\r\n\t\t\tfor (var i = 0; i < contactNodes.length; i++) {\r\n\t\t\t\tvar isNodeInLoop = false;\r\n\t\t\t\tfor (var j = 0; j < loop.length; j++) {\r\n\t\t\t\t\tif (contactNodes[i] === loop[j]) {\r\n\t\t\t\t\t\tisNodeInLoop = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!isNodeInLoop) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\t//Find path from start to end in segment\r\n\tthis.findChain = function (segment, start, end) {\r\n\t\tvar path = [];\r\n\t\tpath.push(start);\r\n\t\t\r\n\t\tvar visitedNodes = {};\r\n\t\tif (end === undefined) {\r\n\t\t\treturn deepSearch(segment, undefined, start, start, path);\r\n\t\t}\r\n\t\treturn deepSearch(segment, undefined, start, end, path);\r\n\t\t\r\n\t\tfunction deepSearch(segment, prev, current, end, path) {\r\n\t\t\tfor (var key in segment.graph.nodes[current].neighbors) {\r\n\t\t\t\tif (key === prev) continue;\r\n\t\t\t\tif (visitedNodes[key]) continue;\r\n\t\t\t\tif (key === end) {\r\n\t\t\t\t\tpath.push(end);\r\n\t\t\t\t\treturn path;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvisitedNodes[key] = true;\r\n\t\t\t\tvar newPath = path.slice();\r\n\t\t\t\tnewPath.push(key);\r\n\t\t\t\tvar res = deepSearch(segment, current, key, end, newPath);\r\n\t\t\t\tif (res != []) {\r\n\t\t\t\t\treturn res;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\r\n\tthis.removeChain = function (graph, chain) {\r\n\t\tvar chainToDelete = [];\r\n\t\tfor (var i = 0; i < chain.length - 1; i++) {\r\n\t\t\tchainToDelete.push({\r\n\t\t\t\tbegin: chain[i],\r\n\t\t\t\tend: chain[i + 1]\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tchainToDelete.push({\r\n\t\t\tbegin: chain[0],\r\n\t\t\tend: chain[chain.length - 1]\r\n\t\t});\r\n\t\t\r\n\t\tgraph.removeEdgesWithRemovingAloneNodes(chainToDelete);\r\n\t}\r\n\t\r\n\tthis.useSpringEmbedder = function (planaredGraph) {\r\n\t\tvar springEmbedderEdges = this.convertEdgesForSpringEmbedder(planaredGraph.edges);\r\n\t\tvar springEmbedderWorker = new SpringEmbedderWorker(svgField);\r\n\t\tspringEmbedderWorker.nodes = planaredGraph.nodes;\r\n\t\tspringEmbedderWorker.edges = springEmbedderEdges;\r\n\t\t\r\n\t\tvar svgGraphDrawer = new SvgGraphDrawer(svgField);\r\n\t\t\r\n\t\tvar timer = setInterval(() => {\r\n\t\t\tspringEmbedderWorker.oneIteration();\r\n\t\t\tsvgGraphDrawer.draw(planaredGraph.nodes, planaredGraph.edges);\r\n\t\t}, 150);\r\n\t\treturn timer;\r\n\t}\r\n\t\r\n\tthis.convertEdgesForSpringEmbedder = function (edges) {\r\n\t\tvar springEmbedderEdges = {};\r\n\t\tfor (var i = 0; i < edges.length; i++) {\r\n\t\t\tif (!springEmbedderEdges[edges[i].begin]) {\r\n\t\t\t\tspringEmbedderEdges[edges[i].begin] = {};\r\n\t\t\t}\r\n\t\t\tspringEmbedderEdges[edges[i].begin][edges[i].end] = true;\r\n\t\t\t\r\n\t\t\tif (!springEmbedderEdges[edges[i].end]) {\r\n\t\t\t\tspringEmbedderEdges[edges[i].end] = {};\r\n\t\t\t}\r\n\t\t\tspringEmbedderEdges[edges[i].end][edges[i].begin] = true;\r\n\t\t}\r\n\t\t\r\n\t\treturn springEmbedderEdges;\r\n\t}\r\n\t\r\n\tthis.addNonPlanarEdges = function (component) {\r\n\t\tvar planaredGraph = component.planaredGraph;\r\n\t\tvar badSegments = component.badSegments;\r\n\t\tvar graph = component.graph;\r\n\t\t\r\n\t\tvar badChain;\r\n\t\tvar svgGraphDrawer = new SvgGraphDrawer(svgField);\r\n\t\twhile (badSegments.length !== 0) {\r\n\t\t\tbadChain = this.findChain(badSegments[0], badSegments[0].contactNodes[0], badSegments[0].contactNodes[1]);\r\n\t\t\t\r\n\t\t\tplanaredGraph.addBadChain(badChain);\r\n\t\t\tthis.removeChain(graph, badChain);\r\n\t\t\tbadSegments = this.findSegments(graph, planaredGraph.addedNodes);\r\n\t\t\tsvgGraphDrawer.draw(planaredGraph.nodes, planaredGraph.edges);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default HammaAlgorithmWorker;\n\n\n// WEBPACK FOOTER //\n// ./src/hamma-algorithm/hamma-algorithm.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/main.scss\n// module id = 6\n// module chunks = 0","import SpringEmbedderWorker from 'spring-embedder';\r\n\r\nimport AdjacencyList from 'adjacency-list';\r\nimport {findBridges} from 'find-bridges';\r\nimport HammaAlgorithmWorker from 'hamma-algorithm';\r\n\r\nimport './main.scss';\r\n\r\nimport {canvasSize} from 'canvas-parameters';\r\nvar height = canvasSize.height;\r\nvar width = canvasSize.width;\r\n\r\nvar timerId;\r\n\r\nvar drawField = document.getElementById(\"drawField\");\r\ndrawField.setAttribute('height', height + \"px\");\r\ndrawField.setAttribute('width', width + \"px\");\r\n/*1->2;2->3;3->4;4->5;5->6;6->7;7->8; 11->12;12->13;13->14;\r\n14->15;15->16;16->17;17->18; 21->22;22->23;23->24;24->25;25->26;26->27;27->28;\r\n 1->11;2->12;3->13;4->14;5->15;6->16;7->17;8->18; 21->11;22->12;23->13;24->14;25->15;26->16;27->17;28->18;\r\n 24->24a;25->25a;24a->25a;23->24a; 2a->2;2b->2;2c->2; 8a->8;8b->8;8c->8; 26a->26;27a->27;28a->28;26a->27a;27a->28a;\r\n 27a->28;27a->27b;27b->27c;27c->27h;27f->27c;27h->27f;*/\r\n/*document.getElementById(\"nodes-input\").value = `1->2;1->6;\r\n2->3;2->5;2->9;2->10;\r\n3->4;3->5;\r\n4->5;\r\n6->7;6->8;\r\n7->8;\r\n9->10;\r\n9->11;\r\n10->11;`;\r\n*/\r\n/*document.getElementById(\"nodes-input\").value = `a->b; a->c; a->d; a->e; a->f; a->k;\r\na->l;\r\nb->c; b->d; b->e; b->f; b->k; b->l;\r\nc->d; c->e; c->f; c->k; c->l;\r\nd->e; d->f; d->k; d->l;\r\ne->f; e->k; e->l;\r\nf->k;f->l;\r\nk->l;`;*/\r\n/*1->2;1->3;1->4;1->4;1->5;\r\n2->3;2->4;2->5;\r\n3->4;3->5;\r\n4->5;*/\r\ndocument.getElementById(\"nodes-input\").value = `1->2;1->3;1->4;1->4;1->5;\r\n2->3;2->4;2->5;\r\n3->4;3->5;\r\n4->5;`;\r\n\r\n//spring-embedder\r\nvar springEmbedderWorker = new SpringEmbedderWorker(drawField);\r\n\r\nvar randomizeNodesAndDraw = document.getElementById(\"randomize-nodes-and-draw\");\r\nrandomizeNodesAndDraw.addEventListener('click', function () {\r\n\tvar nodesText = document.getElementById(\"nodes-input\").value.replace(/ |\\n/g,'').split(';');\r\n\tspringEmbedderWorker.firstStep(nodesText, height, width);\r\n});\r\n\r\nvar calculateOffset = document.getElementById(\"calculate-offset\");\r\ncalculateOffset.addEventListener('click', function () {\r\n\tspringEmbedderWorker.makeOneStabilization();\r\n});\r\n\r\nvar startStab = document.getElementById(\"start-stabilization\");\r\nstartStab.addEventListener('click', function () {\r\n\tspringEmbedderWorker.startStabilization();\r\n});\r\n\r\n//hamma-algorithm\r\nvar hammaAlgorithmWorker = new HammaAlgorithmWorker(drawField);\r\n\r\nvar planarityFirstStep = document.getElementById(\"planarity\");\r\nvar planarComponents = [];\r\nplanarityFirstStep.addEventListener('click', function () {\r\n\tspringEmbedderWorker.clearTimers();\r\n\tvar nodesText = document.getElementById(\"nodes-input\").value.replace(/ |\\n/g,'').split(';');\r\n\t\r\n\tvar initGraph = new AdjacencyList();\r\n\tinitGraph.initializeFromText(nodesText);\r\n\t\r\n\tplanarComponents = hammaAlgorithmWorker.makePlanarity(initGraph);\r\n});\r\n\r\nvar useSpringEmbedderToPlanarGraph = document.getElementById(\"planarity-to-spring\");\r\nvar timers = [];\r\nuseSpringEmbedderToPlanarGraph.addEventListener('click', function () {\r\n\tif (timers.length !== 0) {\r\n\t\tstopTimers(timers);\r\n\t\ttimers = [];\r\n\t\treturn;\r\n\t}\r\n\tfor (var i = 0; i < planarComponents.length; i++) {\r\n\t\tvar currTimer = hammaAlgorithmWorker.useSpringEmbedder(planarComponents[i].planaredGraph);\r\n\t\ttimers.push(currTimer);\r\n\t}\r\n\tfunction stopTimers (timers) {\r\n\t\tfor (var i = 0; i < timers.length; i++) {\r\n\t\t\tclearInterval(timers[i]);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nvar addNonPlanarEdges = document.getElementById(\"add-non-planar-edges\");\r\naddNonPlanarEdges.addEventListener('click', function () {\r\n\tfor (var i = 0; i < planarComponents.length; i++) {\r\n\t\thammaAlgorithmWorker.addNonPlanarEdges(planarComponents[i]);\r\n\t}\r\n});\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","import Plane from 'plane';\r\nimport SvgGraphDrawer from 'svg-graph-drawer';\r\n\r\n/*const canvasSize = {\r\n\twidth: 1800,\r\n\theight: 1800\r\n}\r\nconst center = {\r\n\tx: 900,\r\n\ty: 900\r\n};*/\r\nimport {canvasSize, canvasCenter} from 'canvas-parameters';\r\n\r\nconst nodeRadius = 15;\r\n\r\nconst canvasCorners = {\r\n\ttopLeft: {\r\n\t\tx: nodeRadius,\r\n\t\ty: nodeRadius,\r\n\t\ttype: \"fictive\"\r\n\t},\r\n\ttopRight: {\r\n\t\tx: canvasSize.width - nodeRadius,\r\n\t\ty: nodeRadius,\r\n\t\ttype: \"fictive\"\r\n\t},\r\n\tbottomLeft: {\r\n\t\tx: nodeRadius,\r\n\t\ty: canvasSize.height - nodeRadius,\r\n\t\ttype: \"fictive\"\r\n\t},\r\n\tbottomRight: {\r\n\t\tx: canvasSize.width - nodeRadius,\r\n\t\ty: canvasSize.height - nodeRadius,\r\n\t\ttype: \"fictive\"\r\n\t}\r\n};\r\n\r\n\r\nlet uniqueHelpPointId = 1;\r\n\r\nfunction PlaneWorker () {//добавить хранилище контактных вершин\r\n\tthis.initializeFromLoop = function (loop) {\r\n\t\tthis.nodes = {};\r\n\t\tthis.edges = [];\r\n\t\tthis.addedNodes = loop.slice();\r\n\t\t\r\n\t\tvar radius = loop.length * 25;\r\n\t\tradius = Math.min(radius, 300);\r\n\r\n\t\tvar angle = (2 * Math.PI) / loop.length;\r\n\t\t\r\n\t\tfor (var i = 0; i < loop.length; i++) {\r\n\t\t\tthis.nodes[loop[i]] = {\r\n\t\t\t\tx: canvasCenter.x + radius * Math.cos(i * angle),\r\n\t\t\t\ty: canvasCenter.y + radius * Math.sin(i * angle),\r\n\t\t\t\ttype: \"normal\"\r\n\t\t\t};\r\n\t\t}\r\n\t\t\r\n\t\tfor (var i = 0; i < loop.length - 1; i++) {\r\n\t\t\tthis.edges.push({\r\n\t\t\t\tbegin: loop[i],\r\n\t\t\t\tend: loop[i + 1]\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tthis.edges.push({\r\n\t\t\tbegin: loop[0],\r\n\t\t\tend: loop[loop.length - 1]\r\n\t\t});\r\n\t\t\r\n\t\tthis.nodes[\"topLeft\"] = canvasCorners.topLeft;\r\n\t\tthis.nodes[\"topRight\"] = canvasCorners.topRight;\r\n\t\tthis.nodes[\"bottomLeft\"] = canvasCorners.bottomLeft;\r\n\t\tthis.nodes[\"bottomRight\"] = canvasCorners.bottomRight;\r\n\t\tthis.nodes[\"touchPoint\"] = {\r\n\t\t\tx: canvasSize.width - nodeRadius,\r\n\t\t\ty: this.nodes[loop[0]].y,\r\n\t\t\ttype: \"fictive\"\r\n\t\t}\r\n\t\t\r\n\t\tthis.planes = [];\r\n\t\tthis.planes.push(new Plane(loop, false));\r\n\t\t\r\n\t\tvar outerLoop = loop.slice();\r\n\t\touterLoop.push(loop[0]);\r\n\t\touterLoop.push(\"touchPoint\");\r\n\t\touterLoop.push(\"topRight\");\r\n\t\touterLoop.push(\"topLeft\");\r\n\t\touterLoop.push(\"bottomLeft\");\r\n\t\touterLoop.push(\"bottomRight\");\r\n\t\touterLoop.push(\"touchPoint\");\r\n\t\tthis.planes.push(new Plane(outerLoop, true));  //добавь тип грани(внутр внешн)\r\n\t}\r\n\t\r\n\tthis.addChain = function (chain, plane) {\r\n\t\tvar triangles = findTriangles(plane, this.nodes);\r\n\t\t\r\n\t\tvar path = findPathFromTriangles(chain, triangles, plane.loop, this.nodes);\r\n\t\t\r\n\t\tpath = putChainToPath(path, chain);\r\n\t\t\r\n\t\taddPathToGraph(path, this.nodes, this.edges);\r\n\t\t\r\n\t\taddChainToAddedNodes.call(this, chain);\r\n\t\t\r\n\t\tvar helpPlaneInfo = {};\r\n\t\tif (plane.isOuter) {\r\n\t\t\thelpPlaneInfo = isPlaneLoopBroken(plane.loop, path, this.nodes);\r\n\t\t}\r\n\t\tvar newPlanes = plane.addChain(path.map(pathItem => {\r\n\t\t\treturn pathItem.name;\r\n\t\t}), helpPlaneInfo);\r\n\t\t\r\n\t\tthis.planes = this.planes.filter(item => {\r\n\t\t\tif (item.id === plane.id) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\t\t\r\n\t\tthis.planes.push(newPlanes[0]);\r\n\t\tthis.planes.push(newPlanes[1]);\r\n\t\t\r\n\t\t\r\n\t\tfunction findTriangles (plane, nodes) {\r\n\t\t\tvar triangles = [];\r\n\t\t\tvar edges = getEdgesFromLoop(plane.loop, nodes)\r\n\t\t\tvar newEdges = [];\r\n\t\t\tvar loop = plane.loop.slice();\r\n\t\t\tfor (var i = 0; loop.length > 3; i++) {\r\n\t\t\t\tvar startName = loop[i % loop.length];\r\n\t\t\t\tvar middle = loop[(i + 1) % loop.length];\r\n\t\t\t\tvar endName = loop[(i + 2) % loop.length];\r\n\t\t\t\tif (isCrosingWithPolygonEdges(nodes[startName], nodes[endName], edges)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (isCrosingWithPolygonEdges(nodes[startName], nodes[endName], newEdges)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (!isNodeInsidePoligone({\r\n\t\t\t\t\tx: (nodes[startName].x + nodes[endName].x)/2,\r\n\t\t\t\t\ty: (nodes[startName].y + nodes[endName].y)/2\r\n\t\t\t\t}, plane, nodes)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\ttriangles.push([startName, middle, endName]);\r\n\t\t\t\tnewEdges.push({\r\n\t\t\t\t\tbegin: {\r\n\t\t\t\t\t\tx: nodes[startName].x,\r\n\t\t\t\t\t\ty: nodes[startName].y\r\n\t\t\t\t\t},\r\n\t\t\t\t\tend: {\r\n\t\t\t\t\t\tx: nodes[endName].x,\r\n\t\t\t\t\t\ty: nodes[endName].y\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tloop.splice((i + 1) % loop.length,1);\r\n\t\t\t}\r\n\t\t\ttriangles.push([loop[0], loop[1], loop[2]]);\r\n\t\t\t\r\n\t\t\tvar svgField = document.getElementById(\"drawField\");\r\n\t\t\tvar svgGraphDrawer = new SvgGraphDrawer(svgField);\r\n\t\t\tsvgGraphDrawer.drawHelpLines(newEdges);\r\n\t\t\treturn triangles;\r\n\t\t\t\r\n\t\t\tfunction getEdgesFromLoop (loop, nodes) {\r\n\t\t\t\tvar edges = [];\r\n\t\t\t\tfor (var i = 0; i < plane.loop.length - 1; i++) {\r\n\t\t\t\t\tedges.push({\r\n\t\t\t\t\t\tbegin: {\r\n\t\t\t\t\t\t\tx: nodes[loop[i]].x,\r\n\t\t\t\t\t\t\ty: nodes[loop[i]].y\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tend: {\r\n\t\t\t\t\t\t\tx: nodes[loop[i + 1]].x,\r\n\t\t\t\t\t\t\ty: nodes[loop[i + 1]].y\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tedges.push({\r\n\t\t\t\t\tbegin: {\r\n\t\t\t\t\t\t\tx: nodes[loop[0]].x,\r\n\t\t\t\t\t\t\ty: nodes[loop[0]].y\r\n\t\t\t\t\t},\r\n\t\t\t\t\tend: {\r\n\t\t\t\t\t\t\tx: nodes[loop[loop.length - 1]].x,\r\n\t\t\t\t\t\t\ty: nodes[loop[loop.length - 1]].y\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn edges;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction isCrosingWithPolygonEdges(start, end, edges) {\r\n\t\t\t\tfor (var i = 0; i < edges.length; i++) {\r\n\t\t\t\t\tif (areCrossing(start, end, edges[i].begin, edges[i].end)) return true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction areCrossing (p1, p2, p3, p4) {\r\n\t\t\t\tvar v1 = vectorMult(p4.x - p3.x, p4.y - p3.y, p1.x - p3.x, p1.y - p3.y);\r\n\t\t\t\tvar v2 = vectorMult(p4.x - p3.x, p4.y - p3.y, p2.x - p3.x, p2.y - p3.y);\r\n\t\t\t\tvar v3 = vectorMult(p2.x - p1.x, p2.y - p1.y, p3.x - p1.x, p3.y - p1.y);\r\n\t\t\t\tvar v4 = vectorMult(p2.x - p1.x, p2.y - p1.y, p4.x - p1.x, p4.y - p1.y);\r\n\t\t\t\tif (v1 == 0 && v2 == 0 && v3 == 0 && v4 == 0) {\r\n\t\t\t\t\tvar l1 = Math.sqrt(sqr(p1.x - p2.x) + sqr(p1.y - p2.y));\r\n\t\t\t\t\tvar l2 = Math.sqrt(sqr(p3.x - p4.x) + sqr(p3.y - p4.y));\r\n\t\t\t\t\treturn sqr((p1.x + p2.x) - (p3.x + p4.x)) + sqr((p1.y + p2.y) - (p3.y + p4.y)) <= sqr(l1 + l2);\r\n\t\t\t\t}\r\n\t\t\t\tif ((v1 * v2) < 0 && (v3 * v4) < 0 ) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t\t\r\n\t\t\t\tfunction vectorMult (ax, ay, bx, by) {\r\n\t\t\t\t\treturn ax * by - bx * ay;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfunction sqr (x) {\r\n\t\t\t\t\treturn x*x;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction isNodeInsidePoligone (point, plane, nodes) {\r\n\t\t\t\t//https://github.com/substack/point-in-polygon\r\n\t\t\t\tvar x = point.x, y = point.y;\r\n\t\t\t\tvar inside = false;\r\n\t\t\t\t\r\n\t\t\t\tfor (var i = 0, j = plane.loop.length - 1; i < plane.loop.length; j = i++) {\r\n\t\t\t\t\tvar xi = nodes[plane.loop[i]].x, yi = nodes[plane.loop[i]].y;\r\n\t\t\t\t\tvar xj = nodes[plane.loop[j]].x, yj = nodes[plane.loop[j]].y;\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar intersect = ((yi > y) != (yj > y)) \r\n\t\t\t\t\t\t&& (x < (xj - xi) * (y - yi) / (yj - yi) + xi);\r\n\t\t\t\t\tif (intersect) {\r\n\t\t\t\t\t\tinside = !inside;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn inside;\r\n\t\t\t}\r\n\t\t\r\n\t\t\t/*function isNormalAnlges(point1, point2, point3) {\r\n\t\t\t\tvar normalAngle = 5;\r\n\t\t\t\tvar a = getLengthOfLineSegment(point1, point2);\r\n\t\t\t\tvar b = getLengthOfLineSegment(point2, point3);\r\n\t\t\t\tvar c = getLengthOfLineSegment(point1, point3);\r\n\t\t\t\t\r\n\t\t\t\tvar kc = Math.acos(((a*a)+(b*b)-(c*c))/(2*a*b));\r\n\t\t\t\tkc = (kc*180)/Math.PI;\r\n\t\t\t\tvar kb = Math.acos(((a*a)+(c*c)-(b*b))/(2*a*c));\r\n\t\t\t\tkb = (kb*180)/Math.PI;\r\n\t\t\t\tvar ka = Math.acos(((c*c)+(b*b)-(a*a))/(2*c*b));\r\n\t\t\t\tka = (ka*180)/Math.PI;\r\n\t\t\t\t\r\n\t\t\t\tif (kc < normalAngle || kb < normalAngle || ka < normalAngle) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfunction getLengthOfLineSegment(point1, point2) {\r\n\t\t\t\t\tvar x = point1.x - point2.x;\r\n\t\t\t\t\tvar y = point1.y - point2.y;\r\n\t\t\t\t\treturn Math.sqrt(x*x + y*y);\r\n\t\t\t\t}\r\n\t\t\t}*/\r\n\t\t}\r\n\t\t\r\n\t\tfunction findPathFromTriangles(chain, triangles, loop, nodes) {\r\n\t\t\tvar trianglesPath = [];\r\n\t\t\tvar triangelsToSearch = triangles.map(triangleItem => ({\r\n\t\t\t\tisVisited: false,\r\n\t\t\t\ttriangle: triangleItem\r\n\t\t\t}));\r\n\t\t\t//get triangles that contains chain init node\r\n\t\t\tfor (var i = 0; i < triangelsToSearch.length; i++) {\r\n\t\t\t\tif (isNodeInTriangle(chain[0], triangelsToSearch[i].triangle)) {\r\n\t\t\t\t\ttrianglesPath.push({\r\n\t\t\t\t\t\tpath: [],\r\n\t\t\t\t\t\ttriangle: triangelsToSearch[i].triangle\r\n\t\t\t\t\t});\r\n\t\t\t\t\ttriangelsToSearch[i].isVisited = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//add method, if chain starts and ends in the same place\r\n\t\t\t\r\n\t\t\t//find if possible triangles, that contains first and last elements from chain\r\n\t\t\tfor (var i = 0; i < trianglesPath.length; i++) {\r\n\t\t\t\tif (isNodeInTriangle(chain[chain.length - 1], trianglesPath[i].triangle)) {\r\n\t\t\t\t\t//add support of long path\r\n\t\t\t\t\treturn handleOneTrianglePath(trianglesPath[i].triangle, chain[0], chain[chain.length - 1], loop, nodes);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar isPathFind = false;\r\n\t\t\tvar prePath = [];\r\n\t\t\twhile (!isPathFind) {\r\n\t\t\t\tvar newTrianglesPath = [];\r\n\t\t\t\tfor (var i = 0; i < trianglesPath.length; i++) {\r\n\t\t\t\t\tfor (var j = 0; j < triangelsToSearch.length; j++) {\r\n\t\t\t\t\t\tif (triangelsToSearch[j].isVisited) continue;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar contactEdge = FindIfTriangleTouchAnotherTriangle(trianglesPath[i].triangle, triangelsToSearch[j].triangle);\r\n\t\t\t\t\t\tif (contactEdge !== undefined) {\r\n\t\t\t\t\t\t\tvar newPath = trianglesPath[i].path.slice();\r\n\t\t\t\t\t\t\tnewPath.push(contactEdge);\r\n\t\t\t\t\t\t\tnewTrianglesPath.push({\r\n\t\t\t\t\t\t\t\tpath: newPath,\r\n\t\t\t\t\t\t\t\ttriangle: triangelsToSearch[j].triangle\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\ttriangelsToSearch[j].isVisited = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttrianglesPath = newTrianglesPath;\r\n\t\t\t\t\r\n\t\t\t\tfor (var k = 0; k < trianglesPath.length; k++) {\r\n\t\t\t\t\tif (isNodeInTriangle(chain[chain.length - 1], trianglesPath[k].triangle)) {\r\n\t\t\t\t\t\tisPathFind = true;\r\n\t\t\t\t\t\tprePath = trianglesPath[k].path;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar path = convertTrianglesPath(prePath, nodes, chain);\r\n\t\t\t\r\n\t\t\treturn path;\r\n\t\t\t\r\n\t\t\tfunction isNodeInTriangle(node, triangle) {\r\n\t\t\t\tfor (var j = 0; j < 3; j++) {\r\n\t\t\t\t\tif (triangle[j] === node) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction handleOneTrianglePath(triangle, node1, node2, loop, nodes) {\r\n\t\t\t\tif (!isEdgeInLoop(node1, node2, loop)) {\r\n\t\t\t\t\tvar path = [];\r\n\t\t\t\t\tpath.push(getPathElem(node1, nodes));\r\n\t\t\t\t\tpath.push(getPathElem(node2, nodes));\r\n\t\t\t\t\treturn path;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar p1 = {\r\n\t\t\t\t\tx: nodes[triangle[0]].x,\r\n\t\t\t\t\ty: nodes[triangle[0]].y\r\n\t\t\t\t};\r\n\t\t\t\tvar p2 = {\r\n\t\t\t\t\tx: nodes[triangle[1]].x,\r\n\t\t\t\t\ty: nodes[triangle[1]].y\r\n\t\t\t\t};\r\n\t\t\t\tvar p3 = {\r\n\t\t\t\t\tx: nodes[triangle[2]].x,\r\n\t\t\t\t\ty: nodes[triangle[2]].y\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\tvar x = (p1.x + p2.x + p3.x)/3;\r\n\t\t\t\tvar y = (p1.y + p2.y + p3.y)/3;\r\n\t\t\t\t\r\n\t\t\t\tvar path = [];\r\n\t\t\t\tpath.push(getPathElem(node1, nodes));\r\n\t\t\t\tpath.push({\r\n\t\t\t\t\tname: \"helpNode\" + uniqueHelpPointId,\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y,\r\n\t\t\t\t\ttype: \"helpNode\"\r\n\t\t\t\t})\r\n\t\t\t\tpath.push(getPathElem(node2, nodes));\r\n\t\t\t\tuniqueHelpPointId++;\r\n\t\t\t\treturn path;\r\n\t\t\t\t\r\n\t\t\t\tfunction getPathElem(nodeName, nodes) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tname: nodeName,\r\n\t\t\t\t\t\tx: nodes[nodeName].x,\r\n\t\t\t\t\t\ty: nodes[nodeName].y,\r\n\t\t\t\t\t\ttype: nodes[nodeName].type\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction isEdgeInLoop(node1, node2, loop) {\r\n\t\t\t\tfor (var i = 0; i < loop.length; i++) {\r\n\t\t\t\t\tif (loop[i] === node1) {\r\n\t\t\t\t\t\tvar prev = i - 1, next = i + 1;\r\n\t\t\t\t\t\tif (next === loop.length) {\r\n\t\t\t\t\t\t\tnext = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (prev === -1) {\r\n\t\t\t\t\t\t\tprev = loop.length - 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (loop[next] === node2) {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (loop[prev] === node2) {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\r\n\t\t\tfunction FindIfTriangleTouchAnotherTriangle (triangle1, triangle2) {\r\n\t\t\t\tfor (var i = 0; i < 2; i++) {\r\n\t\t\t\t\tif (isNodeInTriangle(triangle1[i], triangle2) && isNodeInTriangle(triangle1[i + 1], triangle2)) {\r\n\t\t\t\t\t\treturn [triangle1[i], triangle1[i + 1]];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (isNodeInTriangle(triangle1[0], triangle2) && isNodeInTriangle(triangle1[triangle1.length - 1], triangle2)) {\r\n\t\t\t\t\treturn [triangle1[0], triangle1[triangle1.length - 1]];\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t\r\n\t\t\tfunction convertTrianglesPath(prePath, nodes, chain) {\r\n\t\t\t\t//add support of long path\r\n\t\t\t\tvar path = [];\r\n\t\t\t\t\r\n\t\t\t\tpath.push(getPathElem(chain[0], nodes));\r\n\t\t\t\t\r\n\t\t\t\tfor (var i = 0; i < prePath.length; i++) {\r\n\t\t\t\t\tvar coordinates = getMiddleOfLineSegment(prePath[i], nodes);\r\n\t\t\t\t\tpath.push({\r\n\t\t\t\t\t\tname: \"helpNode\" + uniqueHelpPointId,\r\n\t\t\t\t\t\tx: coordinates.x,\r\n\t\t\t\t\t\ty: coordinates.y,\r\n\t\t\t\t\t\ttype: \"helpNode\"\r\n\t\t\t\t\t});\r\n\t\t\t\t\tuniqueHelpPointId++;\r\n\t\t\t\t}\r\n\t\t\t\tpath.push(getPathElem(chain[chain.length - 1], nodes));\r\n\t\t\t\t\r\n\t\t\t\treturn path;\r\n\t\t\t\t\r\n\t\t\t\tfunction getMiddleOfLineSegment(segment, nodes) {\r\n\t\t\t\t\tvar node1 = {\r\n\t\t\t\t\t\tx: nodes[segment[0]].x,\r\n\t\t\t\t\t\ty: nodes[segment[0]].y\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar node2 = {\r\n\t\t\t\t\t\tx: nodes[segment[1]].x,\r\n\t\t\t\t\t\ty: nodes[segment[1]].y\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tx: (node1.x + node2.x)/2,\r\n\t\t\t\t\t\ty: (node1.y + node2.y)/2\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tfunction getPathElem(nodeName, nodes) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tname: nodeName,\r\n\t\t\t\t\t\tx: nodes[nodeName].x,\r\n\t\t\t\t\t\ty: nodes[nodeName].y,\r\n\t\t\t\t\t\ttype: nodes[nodeName].type\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfunction putChainToPath(path, chain) {\r\n\t\t\tif (chain.length === 2) {\r\n\t\t\t\treturn path;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (path.length <= chain.length) {\r\n\t\t\t\treturn increasePathLength(path, chain);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn decreasePathLength(path, chain);\r\n\t\t\t\r\n\t\t\tfunction increasePathLength(path, chain) {\r\n\t\t\t\tvar isPathComplete = false;\r\n\t\t\t\twhile (!isPathComplete) {\r\n\t\t\t\t\tfor (var i = 0; i < path.length - 1; i = i + 2) {\r\n\t\t\t\t\t\tif (path.length >= chain.length) {\r\n\t\t\t\t\t\t\tisPathComplete = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t} \r\n\t\t\t\t\t\tvar middle = getMiddle(path[i], path[i + 1]);\r\n\t\t\t\t\t\tpath.splice(i + 1, 0, middle);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfor (var i = 1; i < path.length - 1; i++) {\r\n\t\t\t\t\tpath[i].name = chain[i];\r\n\t\t\t\t\tpath[i].type = \"normal\";\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn path;\r\n\t\t\t\t\r\n\t\t\t\tfunction getMiddle(point1, point2) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tx: (point1.x + point2.x) / 2,\r\n\t\t\t\t\t\ty: (point1.y + point2.y) / 2\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction decreasePathLength(path, chain) {\r\n\t\t\t\tvar each = Math.floor((path.length - 2) / (chain.length - 2 + 1));\r\n\t\t\t\tfor (var i = each, j = 1; j < chain.length - 1; i = i + each, j++) {\r\n\t\t\t\t\tpath[i].name = chain[j];\r\n\t\t\t\t\tpath[i].type = \"normal\";\r\n\t\t\t\t}\r\n\t\t\t\treturn path;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfunction addPathToGraph(path, nodes, edges) {\r\n\t\t\tfor (var i = 0; i < path.length; i++) {\r\n\t\t\t\tnodes[path[i].name] = {\r\n\t\t\t\t\ttype: path[i].type,\r\n\t\t\t\t\tx: path[i].x,\r\n\t\t\t\t\ty: path[i].y\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor (var i = 0; i < path.length - 1; i++) {\r\n\t\t\t\tedges.push({\r\n\t\t\t\t\tbegin: path[i].name,\r\n\t\t\t\t\tend: path[i + 1].name\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tfunction addChainToAddedNodes(chain) {\r\n\t\t\tthis.addedNodes = this.addedNodes.concat(chain);\r\n\t\t}\r\n\t\t\r\n\t\tfunction isPlaneLoopBroken(loop, path, nodes) {\r\n\t\t\tvar loopEdge = {\r\n\t\t\t\tp1: {x: nodes[loop[0]].x, y: nodes[loop[0]].y},\r\n\t\t\t\tp2: {x: nodes[\"touchPoint\"].x, y: nodes[\"touchPoint\"].y}\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tfor (var i = 0; i < path.length - 1; i++) {\r\n\t\t\t\tvar p1 = {x: path[i].x, y: path[i].y};\r\n\t\t\t\tvar p2 = {x: path[i + 1].x, y: path[i + 1].y};\r\n\t\t\t\t\r\n\t\t\t\tif (areCrossingWithTouch(loopEdge.p1, loopEdge.p2, p1, p2)) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tisLoopBroken: true,\r\n\t\t\t\t\t\tnewStartEdge: findNewStartEdge(path)\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn {\r\n\t\t\t\tisLoopBroken: false,\r\n\t\t\t\tnewStartEdge: undefined\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tfunction areCrossingWithTouch (p1, p2, p3, p4) {\r\n\t\t\t\tvar v1 = vectorMult(p4.x - p3.x, p4.y - p3.y, p1.x - p3.x, p1.y - p3.y);\r\n\t\t\t\tvar v2 = vectorMult(p4.x - p3.x, p4.y - p3.y, p2.x - p3.x, p2.y - p3.y);\r\n\t\t\t\tvar v3 = vectorMult(p2.x - p1.x, p2.y - p1.y, p3.x - p1.x, p3.y - p1.y);\r\n\t\t\t\tvar v4 = vectorMult(p2.x - p1.x, p2.y - p1.y, p4.x - p1.x, p4.y - p1.y);\r\n\t\t\t\tif (v1 == 0 && v2 == 0 && v3 == 0 && v4 == 0) {\r\n\t\t\t\t\tvar l1 = Math.sqrt(sqr(p1.x - p2.x) + sqr(p1.y - p2.y));\r\n\t\t\t\t\tvar l2 = Math.sqrt(sqr(p3.x - p4.x) + sqr(p3.y - p4.y));\r\n\t\t\t\t\treturn sqr((p1.x + p2.x) - (p3.x + p4.x)) + sqr((p1.y + p2.y) - (p3.y + p4.y)) <= sqr(l1 + l2);\r\n\t\t\t\t}\r\n\t\t\t\tif ((v1 * v2) <= 0 && (v3 * v4) <= 0 ) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t\t\r\n\t\t\t\tfunction vectorMult (ax, ay, bx, by) {\r\n\t\t\t\t\treturn ax * by - bx * ay;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfunction sqr (x) {\r\n\t\t\t\t\treturn x*x;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction findNewStartEdge(path) {\r\n\t\t\t\tvar newStartEdge = path[1];\r\n\t\t\t\tfor (var i = 1; i < path.length - 1; i++) {\r\n\t\t\t\t\tif (path[i].x > newStartEdge.x) {\r\n\t\t\t\t\t\tnewStartEdge = path[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn newStartEdge.name;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.addBadChain = function (chain) {\r\n\t\tvar X = this.nodes[chain[0]].x - this.nodes[chain[chain.length - 1]].x;\r\n\t\tvar Y = this.nodes[chain[0]].y - this.nodes[chain[chain.length - 1]].y;\r\n\t\tvar deltaX = X / (chain.length - 1);\r\n\t\tvar deltaY = Y / (chain.length - 1);\r\n\t\t\r\n\t\tvar initX = this.nodes[chain[0]].x;\r\n\t\tvar initY = this.nodes[chain[0]].y;\r\n\t\t\r\n\t\tfor (var i = 1; i < chain.length - 1; i++) {\r\n\t\t\tthis.nodes[chain[i]] = {\r\n\t\t\t\ttype: \"bad-normal\",\r\n\t\t\t\tx: initX + deltaX,\r\n\t\t\t\ty: initY + deltaY\r\n\t\t\t};\r\n\t\t\tinitX += deltaX;\r\n\t\t\tinitY += deltaY;\r\n\t\t}\r\n\t\t\r\n\t\tfor (var i = 0; i < chain.length - 1; i++) {\r\n\t\t\tthis.edges.push({\r\n\t\t\t\tbegin: chain[i],\r\n\t\t\t\tend: chain[i + 1],\r\n\t\t\t\tisBad: true\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\taddChainToAddedNodes.call(this, chain);\r\n\t\t\r\n\t\tfunction addChainToAddedNodes(chain) {\r\n\t\t\tthis.addedNodes = this.addedNodes.concat(chain);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default PlaneWorker;\n\n\n// WEBPACK FOOTER //\n// ./src/plane-worker/plane-worker.js","//this class works with coordinates in canvas\r\nvar uniqueID = 0;\r\nfunction Plane (loop, isOuter, id) {\r\n\tthis.loop = loop;\r\n\tthis.isOuter = isOuter;\r\n\tthis.id = uniqueID;\r\n\tuniqueID++;\r\n\t\r\n\t//add chain to plane, divide it to two planes(edges)\r\n\tthis.addChain = function (chain, helpPlaneInfo) {\r\n\t\tif (!this.isOuter || !helpPlaneInfo.isLoopBroken) {\r\n\t\t\treturn this.addSimpleChain(chain);\r\n\t\t}\r\n\t\treturn this.addChainInOuterLoop(chain, helpPlaneInfo.newStartEdge);\r\n\t}\r\n\t\r\n\tthis.addSimpleChain = function (chain) {\r\n\t\tvar loop1 = [];\r\n\t\tvar loop2 = [];\r\n\t\tvar chainToWorkWith = chain.slice();\r\n\t\tvar i;\r\n\t\tfor (i = 0; i < this.loop.length; i++) {\r\n\t\t\tloop1.push(this.loop[i]);\r\n\t\t\tif (this.loop[i] === chainToWorkWith[0] || this.loop[i] === chainToWorkWith[chainToWorkWith.length - 1]) {\r\n\t\t\t\tif (this.loop[i] === chainToWorkWith[chainToWorkWith.length - 1]) {\r\n\t\t\t\t\tchainToWorkWith.reverse();\r\n\t\t\t\t}\r\n\t\t\t\tloop2.push(this.loop[i]);\r\n\t\t\t\ti++;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfor (i; i < this.loop.length; i++) {\r\n\t\t\tloop2.push(this.loop[i]);\r\n\t\t\tif (this.loop[i] === chainToWorkWith[0] || this.loop[i] === chainToWorkWith[chainToWorkWith.length - 1]) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfor (var j = 1; j < chainToWorkWith.length - 1; j++) {\r\n\t\t\tloop1.push(chainToWorkWith[j]);\r\n\t\t}\r\n\t\t\r\n\t\tfor (var j = chainToWorkWith.length - 2; j > 0; j--) {\r\n\t\t\tloop2.push(chainToWorkWith[j]);\r\n\t\t}\r\n\t\t\r\n\t\tloop1.push(this.loop[i]);\r\n\t\ti++;\r\n\t\t\r\n\t\tfor (i; i < this.loop.length; i++) {\r\n\t\t\tloop1.push(this.loop[i]);\r\n\t\t}\r\n\t\t\r\n\t\treturn [new Plane(loop1, isPlaneOuter(loop1)), new Plane(loop2, isPlaneOuter(loop2))];\r\n\t}\r\n\r\n\tthis.addChainInOuterLoop = function (chain, newStartEdge) {\r\n\t\tvar loop1 = [];\r\n\t\tvar loop2 = [];\r\n\t\tvar chainToWorkWith = chain.slice();\r\n\t\t\r\n\t\tvar i;\r\n\t\tfor (i = 0; i < this.loop.length; i++) {\r\n\t\t\tloop1.push(this.loop[i]);\r\n\t\t\tif (this.loop[i] === chainToWorkWith[0] || this.loop[i] === chainToWorkWith[chainToWorkWith.length - 1]) {\r\n\t\t\t\tif (this.loop[i] === chainToWorkWith[chainToWorkWith.length - 1]) {\r\n\t\t\t\t\tchainToWorkWith.reverse();\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var j = 1; j < chainToWorkWith.length - 1; j++) {\r\n\t\t\tloop2.unshift(chainToWorkWith[j]);\r\n\t\t\tif (chainToWorkWith[j] === newStartEdge)\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t\r\n\t\tloop2.push(this.loop[i]);\r\n\t\ti++;\r\n\t\t\r\n\t\tfor (var j = 1; j < chainToWorkWith.length - 1; j++) {\r\n\t\t\tloop1.push(chainToWorkWith[j]);\r\n\t\t}\r\n\t\t\r\n\t\tfor (i; i < this.loop.length; i++) {\r\n\t\t\tloop2.push(this.loop[i]);\r\n\t\t\tif (this.loop[i] === chainToWorkWith[0] || this.loop[i] === chainToWorkWith[chainToWorkWith.length - 1]) {\r\n\t\t\t\tloop1.push(this.loop[i]);\r\n\t\t\t\ti++;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfor (var j = chainToWorkWith.length - 2; j > 0; j--) {\r\n\t\t\tloop2.push(chainToWorkWith[j]);\r\n\t\t\tif (chainToWorkWith[j] === newStartEdge) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfor (i; i < this.loop.length; i++) {\r\n\t\t\tif (this.loop[i] === this.loop[0]) {\r\n\t\t\t\ti++;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tloop1.push(this.loop[i]);\r\n\t\t}\r\n\t\t\r\n\t\tfor (i; i < this.loop.length; i++) {\r\n\t\t\tloop2.push(this.loop[i]);\r\n\t\t}\r\n\t\t\r\n\t\treturn [new Plane(loop1, isPlaneOuter(loop1)), new Plane(loop2, isPlaneOuter(loop2))];\r\n\t}\r\n\t\r\n\tfunction isPlaneOuter(loop) {\r\n\t\tfor (var i = 0; i < loop.length; i++) {\r\n\t\t\tif (loop[i] === \"topRight\") return true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport default Plane;\n\n\n// WEBPACK FOOTER //\n// ./src/plane/plane.js","'use strict'\n\nvar simplify = require('simplify-js');\n\nfunction toPoints(points, tolerance, highestQuality) {\n    var mappedToObjXY = mapPointsArray2ObjectXY(points);\n    var simplified;\n    if (tolerance !== undefined || highestQuality !== undefined) {\n        simplified = simplify(mappedToObjXY, tolerance, highestQuality);\n    } else {\n        simplified = mappedToObjXY;\n    }\n    var converted = catmullRom2bezier(simplified);\n    return converted;\n};\n\nfunction toPath(points, tolerance, highestQuality) {\n    var cubics = toPoints(points, tolerance, highestQuality);\n    var attribute = `M${points[0][0]}, ${points[0][1]}`;\n    for (let i = 0; i < cubics.length; i++) {\n        attribute += `C${cubics[i][0]},${cubics[i][1]} ${cubics[i][2]},${cubics[i][3]} ${cubics[i][4]},${cubics[i][5]}`;\n    }\n    return attribute;\n};\n\nfunction catmullRom2bezier(pts) {\n    var cubics = [];\n    for (var i = 0, iLen = pts.length; i < iLen; i++) {\n        var p = [\n            pts[i - 1],\n            pts[i],\n            pts[i + 1],\n            pts[i + 2]\n        ];\n        if (i === 0) {\n            p[0] = {\n                x: pts[0].x,\n                y: pts[0].y\n            }\n        }\n        if (i === iLen - 2) {\n            p[3] = {\n                x: pts[iLen - 2].x,\n                y: pts[iLen - 2].y\n            };\n        }\n        if (i === iLen - 1) {\n            p[2] = {\n                x: pts[iLen - 1].x,\n                y: pts[iLen - 1].y\n            };\n            p[3] = {\n                x: pts[iLen - 1].x,\n                y: pts[iLen - 1].y\n            };\n        }\n        var val = 6;\n        cubics.push([\n            (-p[0].x + val * p[1].x + p[2].x) / val,\n            (-p[0].y + val * p[1].y + p[2].y) / val,\n            (p[1].x + val * p[2].x - p[3].x) / val,\n            (p[1].y + val * p[2].y - p[3].y) / val,\n            p[2].x,\n            p[2].y\n        ]);\n    }\n    return cubics;\n}\n\nfunction mapPointsArray2ObjectXY(points) {\n    return points.map(function(point) {\n        return {\n            x: point[0],\n            y: point[1]\n        };\n    });\n}\n\nfunction mapPointsObjectXY2Array(points) {\n    return points.map(function(point) {\n        return [\n            point.x,\n            point.y\n        ];\n    });\n}\n\nmodule.exports = {\n    toPoints: toPoints,\n    toPath: toPath\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/svg-catmull-rom-spline/index.js\n// module id = 10\n// module chunks = 0","/*\n (c) 2013, Vladimir Agafonkin\n Simplify.js, a high-performance JS polyline simplification library\n mourner.github.io/simplify-js\n*/\n\n(function () { 'use strict';\n\n// to suit your point format, run search/replace for '.x' and '.y';\n// for 3D version, see 3d branch (configurability would draw significant performance overhead)\n\n// square distance between 2 points\nfunction getSqDist(p1, p2) {\n\n    var dx = p1.x - p2.x,\n        dy = p1.y - p2.y;\n\n    return dx * dx + dy * dy;\n}\n\n// square distance from a point to a segment\nfunction getSqSegDist(p, p1, p2) {\n\n    var x = p1.x,\n        y = p1.y,\n        dx = p2.x - x,\n        dy = p2.y - y;\n\n    if (dx !== 0 || dy !== 0) {\n\n        var t = ((p.x - x) * dx + (p.y - y) * dy) / (dx * dx + dy * dy);\n\n        if (t > 1) {\n            x = p2.x;\n            y = p2.y;\n\n        } else if (t > 0) {\n            x += dx * t;\n            y += dy * t;\n        }\n    }\n\n    dx = p.x - x;\n    dy = p.y - y;\n\n    return dx * dx + dy * dy;\n}\n// rest of the code doesn't care about point format\n\n// basic distance-based simplification\nfunction simplifyRadialDist(points, sqTolerance) {\n\n    var prevPoint = points[0],\n        newPoints = [prevPoint],\n        point;\n\n    for (var i = 1, len = points.length; i < len; i++) {\n        point = points[i];\n\n        if (getSqDist(point, prevPoint) > sqTolerance) {\n            newPoints.push(point);\n            prevPoint = point;\n        }\n    }\n\n    if (prevPoint !== point) newPoints.push(point);\n\n    return newPoints;\n}\n\n// simplification using optimized Douglas-Peucker algorithm with recursion elimination\nfunction simplifyDouglasPeucker(points, sqTolerance) {\n\n    var len = points.length,\n        MarkerArray = typeof Uint8Array !== 'undefined' ? Uint8Array : Array,\n        markers = new MarkerArray(len),\n        first = 0,\n        last = len - 1,\n        stack = [],\n        newPoints = [],\n        i, maxSqDist, sqDist, index;\n\n    markers[first] = markers[last] = 1;\n\n    while (last) {\n\n        maxSqDist = 0;\n\n        for (i = first + 1; i < last; i++) {\n            sqDist = getSqSegDist(points[i], points[first], points[last]);\n\n            if (sqDist > maxSqDist) {\n                index = i;\n                maxSqDist = sqDist;\n            }\n        }\n\n        if (maxSqDist > sqTolerance) {\n            markers[index] = 1;\n            stack.push(first, index, index, last);\n        }\n\n        last = stack.pop();\n        first = stack.pop();\n    }\n\n    for (i = 0; i < len; i++) {\n        if (markers[i]) newPoints.push(points[i]);\n    }\n\n    return newPoints;\n}\n\n// both algorithms combined for awesome performance\nfunction simplify(points, tolerance, highestQuality) {\n\n    var sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1;\n\n    points = highestQuality ? points : simplifyRadialDist(points, sqTolerance);\n    points = simplifyDouglasPeucker(points, sqTolerance);\n\n    return points;\n}\n\n// export as AMD module / Node module / browser or worker variable\nif (typeof define === 'function' && define.amd) define(function() { return simplify; });\nelse if (typeof module !== 'undefined') module.exports = simplify;\nelse if (typeof self !== 'undefined') self.simplify = simplify;\nelse window.simplify = simplify;\n\n})();\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/svg-catmull-rom-spline/~/simplify-js/simplify.js\n// module id = 11\n// module chunks = 0"],"sourceRoot":""}